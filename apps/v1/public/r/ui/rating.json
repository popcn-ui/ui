{
  "$schema": "../registry-schema.json",
  "name": "rating",
  "type": "ui",
  "description": "Rating component with star display",
  "files": [
    {
      "path": "components/ui/rating.tsx",
      "type": "registry:ui",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport { StarIcon } from \"lucide-react\"\nimport { cn } from \"@/lib/utils\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nconst ratingVariants = cva(\n  [\n    \"inline-flex items-center gap-1\",\n    \"transition-colors\",\n  ],\n  {\n    variants: {\n      size: {\n        sm: \"text-sm\",\n        md: \"text-base\",\n        lg: \"text-lg\",\n        xl: \"text-xl\",\n      },\n      variant: {\n        default: \"\",\n        aurora: \"\",\n      },\n    },\n    defaultVariants: {\n      size: \"md\",\n      variant: \"default\",\n    },\n  }\n)\n\ninterface RatingProps\n  extends Omit<React.HTMLAttributes<HTMLDivElement>, \"onChange\">,\n    VariantProps<typeof ratingVariants> {\n  value?: number\n  max?: number\n  onChange?: (value: number) => void\n  readOnly?: boolean\n  allowHalf?: boolean\n  showValue?: boolean\n}\n\nfunction getAuroraColorClass(index: number, max: number) {\n  if (max <= 1) return \"text-[rgb(var(--ap-aurora-2))] fill-[rgb(var(--ap-aurora-2))]\"\n  const progress = index / (max - 1)\n  if (progress <= 0.33) return \"text-[rgb(var(--ap-aurora-1))] fill-[rgb(var(--ap-aurora-1))]\"\n  if (progress <= 0.66) return \"text-[rgb(var(--ap-aurora-2))] fill-[rgb(var(--ap-aurora-2))]\"\n  return \"text-[rgb(var(--ap-aurora-3))] fill-[rgb(var(--ap-aurora-3))]\"\n}\n\nfunction Rating({\n  value = 0,\n  max = 5,\n  onChange,\n  readOnly = false,\n  allowHalf = false,\n  showValue = false,\n  size,\n  variant,\n  className,\n  ...props\n}: RatingProps) {\n  const [hoveredIndex, setHoveredIndex] = React.useState<number | null>(null)\n  const [hoveredHalf, setHoveredHalf] = React.useState<boolean>(false)\n\n  const displayValue = hoveredIndex !== null ? hoveredIndex + (hoveredHalf && allowHalf ? 0.5 : 1) : value\n\n  const handleClick = (index: number, isHalf: boolean = false) => {\n    if (readOnly || !onChange) return\n    const newValue = index + (isHalf && allowHalf ? 0.5 : 1)\n    onChange(newValue)\n  }\n\n  const handleMouseEnter = (index: number, isHalf: boolean = false) => {\n    if (readOnly) return\n    setHoveredIndex(index)\n    setHoveredHalf(isHalf && allowHalf)\n  }\n\n  const handleMouseLeave = () => {\n    if (readOnly) return\n    setHoveredIndex(null)\n    setHoveredHalf(false)\n  }\n\n  const getStarFill = (index: number) => {\n    const starValue = index + 1\n    const halfValue = index + 0.5\n\n    if (displayValue >= starValue) {\n      return \"fill\"\n    } else if (allowHalf && displayValue >= halfValue) {\n      return \"half\"\n    }\n    return \"empty\"\n  }\n\n  const getFilledClass = (index: number) => {\n    if (variant === \"aurora\") {\n      return getAuroraColorClass(index, max)\n    }\n    return \"text-yellow-500 fill-yellow-500\"\n  }\n\n  return (\n    <div\n      className={cn(ratingVariants({ size, variant }), className)}\n      {...props}\n    >\n      {Array.from({ length: max }).map((_, index) => {\n        const fill = getStarFill(index)\n        const isHalf = fill === \"half\"\n        const isFilled = fill === \"fill\"\n        \n        return (\n          <div\n            key={index}\n            className=\"relative inline-block\"\n            style={{ width: \"1em\", height: \"1em\" }}\n          >\n            {/* 背景の星（常に表示、右半分用） */}\n            <div\n              className=\"absolute inset-0\"\n              style={{ clipPath: allowHalf ? \"inset(0 0 0 50%)\" : \"none\" }}\n              onMouseEnter={() => handleMouseEnter(index, false)}\n              onMouseLeave={handleMouseLeave}\n              onClick={() => handleClick(index, false)}\n            >\n              <StarIcon\n                className={cn(\n                  \"h-full w-full\",\n                  isFilled\n                    ? getFilledClass(index)\n                    : \"text-muted-foreground\",\n                  !readOnly && \"cursor-pointer hover:scale-110 transition-transform\"\n                )}\n              />\n            </div>\n            {/* 左半分の星（allowHalf時のみ、half/fillの時のみ表示） */}\n            {allowHalf && (\n              <div\n                className=\"absolute inset-0\"\n                style={{ \n                  width: \"50%\",\n                  overflow: \"hidden\"\n                }}\n                onMouseEnter={() => handleMouseEnter(index, true)}\n                onMouseLeave={handleMouseLeave}\n                onClick={(e) => {\n                  e.stopPropagation()\n                  handleClick(index, true)\n                }}\n              >\n                <StarIcon\n                  className={cn(\n                    \"h-full w-full\",\n                    isHalf || isFilled\n                      ? getFilledClass(index)\n                      : \"text-muted-foreground\"\n                  )}\n                  style={{ width: \"200%\" }}\n                />\n              </div>\n            )}\n          </div>\n        )\n      })}\n      {showValue && (\n        <span className=\"ml-2 text-sm text-muted-foreground\">\n          {displayValue.toFixed(allowHalf ? 1 : 0)} / {max}\n        </span>\n      )}\n    </div>\n  )\n}\n\nexport { Rating, ratingVariants, type RatingProps }\n"
    }
  ],
  "dependencies": ["lucide-react", "class-variance-authority", "clsx", "tailwind-merge"],
  "registryDependencies": []
}
